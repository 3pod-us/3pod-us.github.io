<!DOCTYPE html>
<html>
	<head>
	<title>SEGURIDAD JANO - DIGITAL SIGNATURES APPLICATION</title>
	<meta charset="utf-8">
	<meta name="robots" content="noindex, nofollow">
	<meta property='og:locale' content='en_US' />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<link rel="stylesheet" type="text/css" href="application.min.css">
	<script src="turpial.es5.min.js"></script>	
	<script>
		var turpial = new Turpial({
		  core_path: null,  
		  public_path: null,
		});		
		var loadCSS = function(url){ turpial.linkCSS( { files: [url] } ); }
		var includeCSS = function(url){ turpial.includeCSS( { files: [url] } ); }

		includeCSS("materialize.css");
		loadCSS("https://fonts.googleapis.com/css?family=Roboto:300,400,700");
		loadCSS("https://use.fontawesome.com/releases/v5.9.0/css/all.css");
	</script>		
	<style id="root-styles">
	/* all element need to be closed with semi-colon ";" */
	/* do not join with another style tag. */
:root{--color-primary:#312782;--color-secundary:#aec90b;--color-warning:#c9af0a;--color-yellow:#c9af0a;--color-black:#1a1a1a;--color-info:#312782;--color-link:#275082;--color-extralightGrey:#d3ddd9;--color-lightGrey:#a1b6ad;--color-grey:#4b5952;--color-darkGrey:#36403b;--color-error:#c9430a;--color-danger:#c9430a;--color-blue:#3352b8;--color-blue-second:#1948e2;--color-alt-1:#76c90a;--color-alt-2:#40c90a;--color-alt-3:#40c90a;--color-dark-1:#211772;--color-dark-2:#1a106b;--color-dark-3:#130964;--color-dark-4:#0c025d;--color-white:#ffffff;--color-success:#aec90b;--grid-maxWidth:120rem;--grid-gutter:2rem;--font-size:1.6rem;--padding-normal:.75rem;--padding-sides-normal:0 .75rem;--padding-updown-normal:.75rem 0;--font-family:"Roboto","Calibri",sans-serif;--swiper-theme-color:#203b8a;--special-gradient:radial-gradient(circle,rgba(255,255,255,1) 0%,rgba(197,204,241,1) 100%)}
	</style>
	<!-- @author: 3pod.us -->
	<style>
#preloader{text-align:center}body{font-family:Roboto,Calibri,sans-serif}.is-pointer{cursor:pointer}.is-pointerless{cursor:inherit}.is-flex-centered{align-items:center}.rounded-message{border-radius:20px;box-shadow:2px 6px 10px rgba(0,0,0,0.145)!important;transition:all .3s ease}.rounded-message .message-header{border-radius:20px 20px 0 0}.rounded-message .message-body{border-radius:0 0 20px 20px}.lighter{font-weight:200!important}.bold{font-weight:500!important}.bolder{font-weight:700!important}.light{font-weight:300!important}.normal{font-weight:400!important}.offset-0{margin-left:0}.offset-1{margin-left:8.333333333333332%!important}.offset-2{margin-left:16.666666666666664%!important}.offset-3{margin-left:25%}.offset-4{margin-left:33.33333333333333%}.offset-5{margin-left:41.66666666666667%}.offset-6{margin-left:50%}.offset-7{margin-left:58.333333333333336%}.offset-8{margin-left:66.66666666666666%}.offset-9{margin-left:75%}.offset-10{margin-left:83.33333333333334%}.offset-11{margin-left:91.66666666666666%}.offset-0-r{margin-right:0}.offset-1-r{margin-right:8.333333333333332%!important}.offset-2-r{margin-right:16.666666666666664%!important}.offset-3-r{margin-right:25%}.offset-4-r{margin-right:33.33333333333333%}.offset-5-r{margin-right:41.66666666666667%}.offset-6-r{margin-right:50%}.offset-7-r{margin-right:58.333333333333336%}.offset-8-r{margin-right:66.66666666666666%}.offset-9-r{margin-right:75%}.offset-10-r{margin-right:83.33333333333334%}.offset-11-r{margin-right:91.66666666666666%}@media only screen and (max-width:900px){*[class*="offset-"]{margin:auto 0.83333333333333%!important}}.input-field input[type=text]:focus + label,.input-field input[type=password]:focus + label{color:var(--color-primary)!important;font-weight:bolder}.input-field input[type=text]:focus,.input-field input[type=password]:focus{border-bottom:1px solid var(--color-primary)!important;box-shadow:0 1px 0 0 var(--color-primary)!important}

	/*table *{border:1px solid #333;}*/
	</style>
	</head>
	<body>
		<template id="signature-template" class="signature-templates">
		 <table width="540" cellspacing="0" cellpadding="0" border="0" style="width: 540px;max-width: 540px;min-width: 540px; font-family:Verdana,Arial,sans-serif;padding: 0px; border-spacing: 0px; margin: 0px; border-collapse: collapse;">
	        <tbody>
	            <tr border="0" style="border:0 !important">
	                <td>
	                    <table width="100%" cellspacing="0" cellpadding="0" border="0" style="padding: 0px; border-spacing: 0px; margin: 0px; border-collapse: collapse;">
	                        <tbody>
	                            <tr border="0" style="border:0 !important">
	                                <td width="120" style="line-height: 0;font-size: 0; text-align: center;">
	                                    <a href="https://seguridadjano.com/" style="text-decoration: none;outline: 0;">
	                                        <img src="https://i.ibb.co/Q6H6DGc/S-Jano-logo-png.png" width="120" height="" style="display: inline-block;text-align: center;">
	                                    </a>
	                                </td>
	                                <td width="2" align="left" style="padding-left: 20px;padding-right: 20px;">
	                                    <img src="https://i.ibb.co/P4Mtt8j/br.png" width="2" height="90" style="display: block;">
	                                </td>
	                                <td align="left" valign="" style="">
	                                    <p style="margin-left: 0;margin-right: 0; 0;margin-bottom: 2px;margin-top: 0;font-size: 18px;line-height: 18px;font-family:Calibri,Arial,sans-serif;color: #3a3a63;">
	                                        <strong id="signature-name" data-empty="{{ name }}">
	                                        	<!-- ex: Diego Sabogal -->
	                                        	{{ name }}
	                                        </strong>
	                                    </p>
	                                    <p style="margin-left: 0;margin-right: 0; 0;margin-bottom: 15px;margin-top: 0;font-size: 14px;line-height: 14px; font-weight: 400;font-family:Calibri,Arial,sans-serif;color: #aec90b;" id="signature-position" data-empty="{{ position }}">
	                                        <!-- ex: Departamento de Marketing -->
	                                        {{ position }}
	                                    </p>
	                                    <p style="margin-left: 0;margin-right: 0; 0;margin-bottom: 0px;margin-top: 0;font-size: 14px;line-height: 14px; font-weight: 400;font-family:Calibri,Arial,sans-serif;color: #000;">
	                                        <span style="font-size: 0;"><img src="https://i.ibb.co/vd3Y0jY/phone-call.png" border="0" width="12" height="12"></span>&nbsp;
	                                        <a href="tel:{{ phone }}" style="text-decoration: none;outline: 0;color: #000;" id="signature-phone" data-empty="{{ phone }}">
	                                        	<!-- ex: +5786712413 -->
	                                            {{ phone }}
	                                        </a>
	                                    </p>
	                                    <p style="margin-left: 0;margin-right: 0; 0;margin-bottom: 0px;margin-top: 0;font-size: 14px;line-height: 14px; font-weight: 400;font-family:Calibri,Arial,sans-serif;color: #000;">
	                                        <span style="font-size: 0;"><img src="https://i.ibb.co/jgh2Htg/email.png" border="0" width="12" height="11"></span>&nbsp;
	                                        <a href="mailto:{{ email }}" style="text-decoration: none;outline: 0;color: #000;" id="signature-email" data-empty="{{ email }}">
	                                        	<!-- ex:  marketing@seguridadjano.com -->
	                                           {{ email }}
	                                        </a>
	                                    </p>
	                                    <p style="margin-left: 0;margin-right: 0; 0;margin-bottom: 0px;margin-top: 0;font-size: 14px;line-height: 14px; font-weight: 400;font-family:Calibri,Arial,sans-serif;color: #000;">
	                                        <span style="font-size: 0;"><img src="https://i.ibb.co/LQhY0Ng/worldwide.png" border="0" width="12" height="12"></span>&nbsp;
	                                        <a id="signature-webpage" href="https://www.seguridadjano.com" style="text-decoration: none;outline: 0;color: #000;">
	                                        	<!-- ex:  www.seguridadjano.com -->
	                                        	www.seguridadjano.com
	                                        </a>
	                                    </p>
	                                </td>
	                                <td align="right" valign="bottom" style="line-height: 0;font-size: 0; text-align: right;">
	                                    <p style="margin-left: 0;margin-right: 0; 0;margin-bottom: 15px;margin-top: 0;font-size: 0px;">
	                                        <a href="https://sibasc.wbasco.org/mod_consulta_pag_wbo/consulta_empresa.php?empresa_id=1534&capitulo_id=2&session_nomidioma=" style="text-decoration: none;outline: 0;color: #000;">
	                                            <img src="https://i.ibb.co/MRjLKFf/cert1-1.png" border="0" width="35" height="">
	                                        </a><span style="font-size: 13px;">&nbsp;&nbsp;</span>
	                                        <a href="https://sibasc.wbasco.org/mod_consulta_pag_wbo/consulta_empresas_certificadas.php" style="text-decoration: none;outline: 0;color: #000;">
	                                            <img src="https://i.ibb.co/vXrxJyR/veritas2-1.png" border="0" width="70" height="">
	                                        </a>
	                                    </p>
	                                    <p style="margin-left: 0;margin-right: 0; 0;margin-bottom: 0px;margin-top: 0;font-size: 0px;">
	                                        <a href="https://www.facebook.com/seguridadJANO/" style="text-decoration: none;outline: 0;color: #000;">
	                                            <img src="https://i.ibb.co/GtSvP5J/facebook-logo-button.png" border="0" width="22" height="22">
	                                        </a><span style="font-size: 13px;">&nbsp;</span>
	                                        <a href="#" style="text-decoration: none;outline: 0;color: #000;">
	                                            <img src="https://i.ibb.co/0t3FVvG/instagram-2.png" border="0" width="22" height="22">
	                                        </a><span style="font-size: 13px;">&nbsp;</span>
	                                        <a href="https://www.facebook.com/seguridadJANO/" style="text-decoration: none;outline: 0;color: #000;">
	                                            <img src="https://i.ibb.co/D8PrQxy/twitter-4.png" border="0" width="22" height="22">
	                                        </a><span style="font-size: 13px;">&nbsp;</span>
	                                        <a href="#" style="text-decoration: none;outline: 0;color: #000;">
	                                            <img src="https://i.ibb.co/hyrbRvz/youtube-1.png" border="0" width="22" height="22">
	                                        </a>
	                                    </p>
	                                </td>
	                            </tr>
	                        </tbody>
	                    </table>	                    
	                </td>
	            </tr>
	            <tr border="0" style="border:0 !important">
	                <td style="padding-top: 6px">
	                    <img src="https://i.ibb.co/sjRkv2r/br.png" width="540">
	                </td>
	            </tr>
	        </tbody>
	    </table>
	    <table width="540" cellspacing="0" cellpadding="0" border="0" style="width: 100%;max-width: 540px;min-width: 320px; font-family:Verdana,Arial,sans-serif;padding: 0px; border-spacing: 0px; margin: 0px; border-collapse: collapse;border:0;word-break: break-word;">
        	<tr border="0" style="border:0 !important">
        		<td style="font-size: 12px; line-height: 12px; font-family: Calibri,Arial,sans-serif; color: rgb(58,58,99);padding-top: 8px;">
        			<strong data-empty="{{ footer }}" id="signature-footer" style="color: rgb(58,58,99);">
        				{{ footer }}
        			</strong>
        		</td>
        	</tr>
        </table>
	</template>
		<div id="preloader" class="pageloader is-active">					
			<span class="title lighter">
				<img src="https://i.ibb.co/9wFs2Q2/Jano-Logo-White-Transparent.png" style="width: 120px">
				<br>
					<span id="preloader-text">Fetching Components</span>
				<br>...
			</span>
		</div>
		<header class="column is-multiline">
			<section class="column is-10 offset-1 offset-1-r">
				<div class="columns is-multiline">
					<div class="column is-4 is-flex is-flex-centered">
						<img src="https://i.ibb.co/Rbkqm00/Logo-Jano-seguridad-1.png" style="width: 220px">
					</div>
					<div class="column is-8 is-flex is-flex-centered">
						<h1 class="title is-size-4">
			    			<span class="has-text-primary">SEGURIDAD JANO</span>
			    			<br>
			    			<span class="lighter">Digital Signatures Application.</span>
			    		</h1>
					</div>					
				</div>
			</section>
		</header>
		<main class="columns is-multiline">
			<section class="column is-10 offset-1 offset-1-r">
				<div class="columns is-multiline">
					<div class="column is-4">
						<div class="box" style="height: 100%">
							<h2 class="bolder">
								Create a Single Signature
								<span class="has-text-info" data-tooltip="Complete the form and download your signature.">
									<i class="fas fa-info-circle"></i>
								</span>
							</h2>
							<form onkeyup="coreApp.editOnWrite(this)" id="form-main-card" method="POST" onsubmit="event.preventDefault();coreApp.singleDownload()" action="">
								<div class="input-field">
									<input class="formElements" autocomplete="off" id="signature-name-user" type="text" name="name" required="">
									<label for="signature-name-user">Your Name</label>
								</div>
								<div class="input-field">
									<input class="formElements" autocomplete="off" id="signature-position-user" type="text" name="position" required="">
									<label for="signature-position-user">Your Position</label>
								</div>
								<div class="input-field">
									<input class="formElements" autocomplete="off" id="signature-phone-user" type="text" name="phone" value="(8) 6712413 – 6688503" required="">
									<label for="signature-phone-user">Your Phone</label>
								</div>
								<div class="input-field">
									<input class="formElements" autocomplete="off" id="signature-email-user" type="email" name="email" required="">
									<label for="signature-email-user">Your E-mail</label>
								</div>
								<div class="input-field">
									 <textarea id="signature-footer-user" name="footer" class="materialize-textarea formElements" autocomplete="off"></textarea>
									 <label for="signature-footer-user">Footer</label>
								</div>
								<button class="button is-primary is-outlined is-rounded">
									Download Signature
								</button>
							</form>
						</div>
					</div>
					<div class="column is-8">
						<div class="box" style="height: 100%">
							<h2>Template Result: </h2>
							<div id="mainCard" style="overflow-x: auto;">
								<!-- javascript push -->
							</div>							
						</div>
					</div>
					<div class="column is-12 is-hidden">
						<div class="box">
							<h2 class="has-text-centered is-size-4 has-text-primary bolder">
								Upload an Excel File and create many signatures in seconds.
								<br>
								<span class="lighter">
									Excel Structure Example:
								</span>
							</h2>

							<div class="table-container">
								<table class="is-stripped table">
									<tr> 
										<th>correo corporativo</th> 
										<th>celular corporativo</th>
										<th>1er apellido</th>
										<th>2do apellido</th>
										<th>1er nombre</th>
										<th>2do nombre</th>
										<th>cargo</th>
									</tr>
									<tr> 
										<td>hello@seguridadjano.com</td>
										<td>6688503</td>
										<td>LASTNAME 1</td>
										<td>LASTNAME 2</td>
										<td>NAME 1</td>
										<td>NAME 2</td>
										<td>Directora</td>
									</tr>
								</table>
							</div>
							<section class="columns is-multiline">
								<div class="column is-12">
									<hr>
								</div>
								<div class="column is-6">
									<h3 class="has-text-right is-size-5 has-text-primary lighter">
											After select your Excel file, a ZIP file will be downloaded to your device, decompress and see all your HTML signatures files.
											<br />
									</h3>
								</div>
								<div class="column is-6" id="upload-container">
									<span></span>
								</div>
							</section>
						</div>
					</div>						
				</div>
			</section>
		</main>
		<footer class="columns is-multiline">
			
		</footer>
	</body>
</html>
<script>
	/********** GLOBALS *********/
	var IS_ONLINE = false;
	var HOST = window.location.host;
	function bodyInner(s){ document.body.innerHTML = s };
	var allowed_websites = [
		"MTI3LjAuMC4xOjgwODA=",
		"bWFyaWN1dG8ud2Vic2l0ZQ==",
	];
	turpial.fetch({
		files: [
			"application.jano.min.js",
		],
		ready: function(){
			coreApp.preloader.hide();
		},
	});
	var decode = function(s){ return atob(s) };
	var encode = function(s){ return btoa(s) };
	var coreApp = {
		elementTemplate: turpial.find("signature-template").innerHTML,
		form: {
			forms: [],
			retrieve: function(props){
				var app=this;props.form=turpial.find(props.form);var formName=props.form.id;app.forms[formName]={};var elements=props.form.querySelectorAll(props.targets);[...elements].forEach(function(e){if("true"===e.getAttribute("data-array-input"))return"object"!=typeof app.forms[formName][e.name]&&(app.forms[formName][e.name]=[]),void app.forms[formName][e.name].push(e.value);if("radio"===e.type){if(!1===e.checked)return;app.forms[formName][e.name]=e.value}else if("checkbox"===e.type){if(!0===e.checked&&"true"===e.getAttribute("data-boolean"))return void(app.forms[formName][e.name]=!0);if(void 0===app.forms[formName][e.name]&&(app.forms[formName][e.name]={}),!1===e.checked&&"true"===e.getAttribute("data-boolean"))return void(app.forms[formName][e.name]=!1);if(!1===e.checked)return void delete app.forms[formName][e.name][e.value];app.forms[formName][e.name][e.value]=e.value}else app.forms[formName][e.name]=e.value});
				return app.forms[formName];
			}
		},
		layout: function(content){
			return `<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
			<html>
			<head>
				<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
				<title>Email Signature</title>
				<style>
					a{text-decoration:none;}
				</style>
			</head>
			<body>
				${content}
			</body>
			</html>`
		},
		singleDownload: function(){
			var containerCard = turpial.find("mainCard");
			var content = this.layout( containerCard.innerHTML );
			var name = containerCard.querySelector("#signature-name");
			var id = name.innerText.split(" ").join("-");
			var button = turpial.mount(document.body, turpial.el("a", {href: 
				`data:text/plain;charset=UTF-8,${encodeURIComponent(content)}`
			}))
			button.download = id+".html";
			button.click();
			button.remove();
		},
		preloader: {
			element: document.querySelector("#preloader"),
			hide: function(){
				this.element.classList.remove("is-active")
			},
			show: function(text){
				text = text || "Fetching Components";
				this.element.querySelector("#preloader-text").innerText = text
				this.element.classList.add("is-active")
			}
		},
		zipNode: {},
		excelRows: [],
		zipRows: function(){
			var app = this;
			var employeers = this.excelRows;
			var employeersRestructured = [];
			employeers.forEach(function( employeer, keyEmployeer ){
				var rows = Object.values(employeer);
				var keyRows = Object.keys(employeer);
				employeersRestructured[keyEmployeer] = {};

				rows.forEach(function( columnValue, keyColumn ){
					var newName = keyRows[keyColumn].toLowerCase().trim()
					employeersRestructured[keyEmployeer][newName] = columnValue.trim();
				})
				
			})

			employeers = employeersRestructured;
			var zip = new JSZip();
			var htmlFolder = zip.folder("HTML FILES");
			var txtFolder = zip.folder("TXT FILES");
			employeers.forEach(function( employeer ){
				if(typeof employeer["1er nombre"] === "undefined"){return;}
				if(typeof employeer["1er apellido"] === "undefined"){return;}				

				var name = `${employeer["1er nombre"]} ${employeer["1er apellido"]}`;
				var position = employeer["cargo"];
				var phone = "(8) 6712413 – 6688503";
				var email = employeer["correo corporativo"];
				var footer = employeer["footer"] || "";

				var textFILE = app.renderTemplate([{
					name: name,
					position: position,
					phone: phone,
					email: email,
					footer: footer,
				}]);
				var fileName = name.split(" ").join("-").trim().toLowerCase();

				htmlFolder.file(fileName+".html", textFILE);				
				txtFolder.file(fileName+".txt", textFILE);				
			})
			app.zipNode = zip;
			app.preloader.show("getting data and compressing");						
			setTimeout(function(){
				var archive = app.zipNode.generate({type:"base64"});
				var button = turpial.mount(document.body, turpial.el("a", {href: 
					`data:application/zip;base64,${archive}`
				}))
				button.download = "jano-seguridad-signatures.zip";
				button.click();
				button.remove();
			}, 500)			
			setTimeout(function(){
				app.preloader.hide();
				coreApp.createUploadElement();
			}, 3000)
		},
		excelToJSON: function(event){
			var input = event.target;
		    var reader = new FileReader();
		    reader.onload = function(){
		        var fileData = reader.result;
		        var wb = XLSX.read(fileData, {type : 'binary'});

		        wb.SheetNames.forEach(function(sheetName){
		        	var rowObj =XLSX.utils.sheet_to_row_object_array(wb.Sheets[sheetName]);
		        	var jsonObj = JSON.stringify(rowObj);
		        	coreApp.excelRows = rowObj;
		        	coreApp.zipRows();
		        })

		    };
		    reader.readAsBinaryString(input.files[0]);
		    
		},
		editOnWrite: function(form){
			var data = coreApp.form.retrieve({
				form: form,
				targets: ".formElements",
			});
			Object.values(data).forEach(function(value, key){
				var nameKey = Object.keys(data)[key];
				var containerCard = turpial.find("mainCard");
				var element = containerCard.querySelector(`#signature-${nameKey}`);
				if(value === ""){
					// insert variable instace of empty value.
					value = element.getAttribute("data-empty");
				}
				turpial.insert(element, value);
			})
		},
		v: function(){
			var host = enc(HOST);			
			if(	host === allowed_websites[0] 
				|| host === allowed_websites[1]){
				// do nothing
			}else{
				
			}
		},
		createUploadElement: function(){
			var element = turpial.find("upload-container");
			turpial.map(element, [0]).remove();
			var html = `<form enctype="multipart/form-data" onsubmit="event.preventDefault()">
				<div class="file-field input-field">
			      <div class="btn button">
			        <span>File</span>
			        <input type="file" id="upload" onchange="coreApp.excelToJSON(event)" name="files[]" accept=".xls,.xlsx,.csv">
			      </div>
			      <div class="file-path-wrapper">
			        <input class="file-path validate" type="text" readonly="">
			      </div>
			    </div>
			</form>`
			turpial.insert(element,html)
		},
		renderTemplate: function(replacemets, html){
			// this.v(); // uncomment to allow blocker.
			html = html || this.elementTemplate;
			var template = function(template, searchall, replaceby){
				return template.split(searchall).join(replaceby);
			}
			var structure = html;
			replacemets.forEach(function( replacement ){
				var items = Object.keys(replacement);
				var values = Object.values(replacement);
				items.forEach(function( item, key ){						
					item = `{{ ${item} }}`;
					if(html.search(item) >= 0){
						structure = template(structure, item, values[key]);
					}						
				})
			})				
			return structure;
		}
	}


	// first card to create single signatures.
	// "reactive" zone with turpial. 
	var dec = function(s){ return decode(s) };
	var enc = function(s){ return encode(s) };
	var mainCard = coreApp.renderTemplate([{
		name: "My Name & Last Name",
		position: "My Position",
		phone: "(8) 6712413 – 6688503",
		email: "My E-mail",
		footer: "",
	}]);
	coreApp.createUploadElement();
	turpial.insert("mainCard", mainCard);



	var rootStyles = {
		rules: {},
		cssRoot: document.getElementById("root-styles").sheet.cssRules[0],
		cssText: "",
		render: function(){
			var app = this;
			this.cssRoot = document.getElementById("root-styles").sheet.cssRules[0];
			this.cssText = this.cssRoot.cssText;
			[...this.cssRoot.style].forEach(function(rule){
				app.rules[rule] = app.cssText.split(rule+": ")[1].split(";")[0];
			})
		}
	};
	rootStyles.render();
</script>